<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conversation Display</title>
    <style>
        /* Add any styling as needed */
        .speaker {
            font-weight: bold;
        }
    </style>

    <!-- Add these CDN links in the head section of your HTML file -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

</head>
<body>
{{ html_output | safe }}
<button onclick="downloadExcel()">Download Excel</button>

<script>
    function downloadExcel() {
        var jsonData = {{ json_data | tojson | safe }};
        var ws = XLSX.utils.json_to_sheet(jsonData);
        var wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, 'Sheet1');
        var blob = XLSX.write(wb, {
            bookType: 'xlsx',
            type: 'blob',
            mimeType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'
        });
        saveAs(blob, 'output.xlsx');
    }
</script>


</body>
</html>
